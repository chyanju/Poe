# parsed arguments: Namespace(benchmark='Qd3bd0', dsl='meta_visqa', skeletons='visqa_normal', strategy='TaPas_C', fallback='auto', timeout=300, mode='full', expected_only=False)
# loading benchmark...
# table keywords: {'2001', '2014', '149.338', '167.543', '123.061', '2012', '2000', '169.598', '168.827', '129.505', '2015', '2010', '2005', '125.734', '408.037', '2013', '2016', '2011', '2008', '223.809', 'cases', 'year', 'blue', '1999', '186.108', '297.551', '344.23', '1998', '174.935', '2007', '2017', '2002', 'color', '456.216', '262.799', '516.031', '533.909', '166.061', '2006', '325.044', '2004', '184.211', '2009', '2003'}
# input type: [dtype('float64'), dtype('int64'), dtype('O')]
# input is:
      cases  year color
0   129.505  1998  blue
1   123.061  1999  blue
2   125.734  2000  blue
3   149.338  2001  blue
4   166.061  2002  blue
5   169.598  2003  blue
6   167.543  2004  blue
7   184.211  2005  blue
8   168.827  2006  blue
9   174.935  2007  blue
10  186.108  2008  blue
11  223.809  2009  blue
12  262.799  2010  blue
13  297.551  2011  blue
14  325.044  2012  blue
15  344.230  2013  blue
16  408.037  2014  blue
17  456.216  2015  blue
18  516.031  2016  blue
19  533.909  2017  blue
# query is: How many more cases was there in 2017 than in 2010?
# expected output type:[dtype('float64')]
# expected output is:
   ANSWER
0  271.11
# inferred DSL terminals:
  # ConstVal: ['2010@Int', 'cases@Str', '2017@Int', '<NULL>']
     # cmap: [('cases', 'cases'), (2017, 2017), (2010, 2010)]
  # AggrFunc: ['count', '<NULL>']
     # amap: [('how many', 'count')]
  # NumFunc: ['-', '<NULL>']
     # nmap: [('more', '-')]
  # BoolFunc: ['==', '>=', '>', '<NULL>']
     # bmap: [('more', '>='), (None, '=='), ('more', '>')]
  # IndFunc: ['<NULL>']
     # imap: []
# ====> fallback strategy (comparison) is triggered
  # [debug] high_values: [(1754.201, 4), (1476.091, 4), (271.11, 4), (7.0, 4), (-7.0, 4), (-271.11, 4), (-1476.091, 4), (-1754.201, 4)]
  # [debug] high_values (no dup.): [(1893.939, 2), (1891.266, 2), (1887.495, 2), (1886.939, 2), (1884.266, 2), (1880.495, 2), (1867.662, 2), (1860.662, 2), (1850.939, 2), (1849.4569999999999, 2)]
  # [debug] fallback (comparison) answers are added
# loading skeleton list...

# ========== candidate program report ========== #
# (t=0.00) i=0, candidate=[{'ANSWER': 1}]
  # found 9 program(s)
    # Summarize(SelectRow1(@param0, ==, 1, 2010@Int), count, 0)
      --> ['Summarize', ['SelectRow1', 'input@0', '==', 'year', 2010], 'count', 'cases']
    # Summarize(SelectRow1(@param0, ==, 1, 2010@Int), count, 1)
      --> ['Summarize', ['SelectRow1', 'input@0', '==', 'year', 2010], 'count', 'year']
    # Summarize(SelectRow1(@param0, ==, 1, 2010@Int), count, 2)
      --> ['Summarize', ['SelectRow1', 'input@0', '==', 'year', 2010], 'count', 'color']
    # Summarize(SelectRow1(@param0, ==, 1, 2017@Int), count, 0)
      --> ['Summarize', ['SelectRow1', 'input@0', '==', 'year', 2017], 'count', 'cases']
    # Summarize(SelectRow1(@param0, ==, 1, 2017@Int), count, 1)
      --> ['Summarize', ['SelectRow1', 'input@0', '==', 'year', 2017], 'count', 'year']
    # Summarize(SelectRow1(@param0, ==, 1, 2017@Int), count, 2)
      --> ['Summarize', ['SelectRow1', 'input@0', '==', 'year', 2017], 'count', 'color']
    # Summarize(SelectRow1(@param0, >=, 1, 2017@Int), count, 0)
      --> ['Summarize', ['SelectRow1', 'input@0', '>=', 'year', 2017], 'count', 'cases']
    # Summarize(SelectRow1(@param0, >=, 1, 2017@Int), count, 1)
      --> ['Summarize', ['SelectRow1', 'input@0', '>=', 'year', 2017], 'count', 'year']
    # Summarize(SelectRow1(@param0, >=, 1, 2017@Int), count, 2)
      --> ['Summarize', ['SelectRow1', 'input@0', '>=', 'year', 2017], 'count', 'color']
# (t=4.92) i=1, candidate=[{'ANSWER': 2}]
  # found 0 program(s)
# (t=9.84) i=2, candidate=[{'ANSWER': 1754.201}]
  # found 0 program(s)
# (t=14.76) i=3, candidate=[{'ANSWER': 1476.091}]
  # found 0 program(s)
# (t=19.70) i=4, candidate=[{'ANSWER': 271.11}]
  # found 2 program(s)
    # Contrast(SelectRow1(@param0, >=, 1, 2010@Int), -, 1, 2017@Int, 2010@Int, 0)
      --> ['Contrast', ['SelectRow1', 'input@0', '>=', 'year', 2010], '-', 'year', 2017, 2010, 'cases']
    # Contrast(@param0, -, 1, 2017@Int, 2010@Int, 0)
      --> ['Contrast', 'input@0', '-', 'year', 2017, 2010, 'cases']
# (t=24.58) i=5, candidate=[{'ANSWER': 7.0}]
  # found 3 program(s)
    # Summarize(SelectRow1(@param0, >, 1, 2010@Int), count, 0)
      --> ['Summarize', ['SelectRow1', 'input@0', '>', 'year', 2010], 'count', 'cases']
    # Summarize(SelectRow1(@param0, >, 1, 2010@Int), count, 1)
      --> ['Summarize', ['SelectRow1', 'input@0', '>', 'year', 2010], 'count', 'year']
    # Summarize(SelectRow1(@param0, >, 1, 2010@Int), count, 2)
      --> ['Summarize', ['SelectRow1', 'input@0', '>', 'year', 2010], 'count', 'color']
# (t=29.50) i=6, candidate=[{'ANSWER': -7.0}]
  # found 0 program(s)
# (t=34.43) i=7, candidate=[{'ANSWER': -271.11}]
  # found 2 program(s)
    # Contrast(SelectRow1(@param0, >=, 1, 2010@Int), -, 1, 2010@Int, 2017@Int, 0)
      --> ['Contrast', ['SelectRow1', 'input@0', '>=', 'year', 2010], '-', 'year', 2010, 2017, 'cases']
    # Contrast(@param0, -, 1, 2010@Int, 2017@Int, 0)
      --> ['Contrast', 'input@0', '-', 'year', 2010, 2017, 'cases']
# (t=39.37) i=8, candidate=[{'ANSWER': -1476.091}]
  # found 0 program(s)
# (t=44.32) i=9, candidate=[{'ANSWER': -1754.201}]
  # found 0 program(s)

# ========== review report ========== #
# top-1, score: 1.51, answer: 271.11
  # tprog: Contrast(@param0, -, 1, 2017@Int, 2010@Int, 0)
# top-2, score: 1.51, answer: -271.11
  # tprog: Contrast(@param0, -, 1, 2010@Int, 2017@Int, 0)
# top-3, score: 1.49, answer: 1
  # tprog: Summarize(SelectRow1(@param0, >=, 1, 2017@Int), count, 0)
# top-4, score: 1.49, answer: 7.0
  # tprog: Summarize(SelectRow1(@param0, >, 1, 2010@Int), count, 0)
# top-5, score: 1.45, answer: 271.11
  # tprog: Contrast(SelectRow1(@param0, >=, 1, 2010@Int), -, 1, 2017@Int, 2010@Int, 0)
# top-6, score: 1.45, answer: -271.11
  # tprog: Contrast(SelectRow1(@param0, >=, 1, 2010@Int), -, 1, 2010@Int, 2017@Int, 0)
# top-7, score: 1.40, answer: 1
  # tprog: Summarize(SelectRow1(@param0, ==, 1, 2010@Int), count, 0)
# top-8, score: 1.40, answer: 1
  # tprog: Summarize(SelectRow1(@param0, ==, 1, 2017@Int), count, 0)
# top-9, score: 1.40, answer: 1
  # tprog: Summarize(SelectRow1(@param0, >=, 1, 2017@Int), count, 1)
# top-10, score: 1.40, answer: 1
  # tprog: Summarize(SelectRow1(@param0, >=, 1, 2017@Int), count, 2)
# top-11, score: 1.40, answer: 7.0
  # tprog: Summarize(SelectRow1(@param0, >, 1, 2010@Int), count, 1)
# top-12, score: 1.40, answer: 7.0
  # tprog: Summarize(SelectRow1(@param0, >, 1, 2010@Int), count, 2)
# top-13, score: 1.31, answer: 1
  # tprog: Summarize(SelectRow1(@param0, ==, 1, 2010@Int), count, 1)
# top-14, score: 1.31, answer: 1
  # tprog: Summarize(SelectRow1(@param0, ==, 1, 2010@Int), count, 2)
# top-15, score: 1.31, answer: 1
  # tprog: Summarize(SelectRow1(@param0, ==, 1, 2017@Int), count, 1)
# top-16, score: 1.31, answer: 1
  # tprog: Summarize(SelectRow1(@param0, ==, 1, 2017@Int), count, 2)
