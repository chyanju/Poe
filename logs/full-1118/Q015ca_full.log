# parsed arguments: Namespace(benchmark='Q015ca', dsl='meta_visqa', skeletons='visqa_normal', strategy='TaPas_C', fallback='auto', timeout=300, mode='full', expected_only=False)
# loading benchmark...
# table keywords: {'0.0', '1.144', '25.601', 'latvia', '5.367', 'uk', 'cyprus', 'republic', '2.375', 'ireland', 'pre', '10.821', 'portugal', 'estonia', '20.938', 'budget', '1.408', '2.199', 'spain', 'austria', '0.176', '5.103', 'hungary', 'lithuania', 'sweden', 'budgetcategory', 'romania', '2.727', 'netherlands', 'poland', '18.651', '11.613', '1.232', '3.695', '0.44', 'denmark', '16.628', 'belgium', 'slovenia', 'finland', '19.795', '1.76', 'greece', 'color', 'malta', '1.496', 'bulgaria', 'italy', 'czech', 'france', 'post', 'orange', '0.264', '4.223', '0.88', '0.616', 'rebate', '6.51', 'blue', 'luxembourg', '14.78', '25.249', 'slovakia', '0.792', '2.551', '15.748', '2.023', 'germany', 'country', '1.672', '3.959', '6.246'}
# input type: [dtype('O'), dtype('O'), dtype('float64'), dtype('O')]
# input is:
           country  budgetcategory  budget   color
0        Lithuania   Pre UK rebate   0.440  orange
1        Lithuania  Post UK rebate   0.440    blue
2           Latvia   Pre UK rebate   0.176  orange
3           Latvia  Post UK rebate   0.176    blue
4         Slovenia   Pre UK rebate   0.616  orange
5         Slovenia  Post UK rebate   0.616    blue
6         Bulgaria   Pre UK rebate   0.616  orange
7         Bulgaria  Post UK rebate   0.616    blue
8         Slovakia   Pre UK rebate   0.792  orange
9         Slovakia  Post UK rebate   0.880    blue
10         Ireland   Pre UK rebate   1.408  orange
11         Ireland  Post UK rebate   1.496    blue
12           Italy   Pre UK rebate  15.748  orange
13           Italy  Post UK rebate  16.628    blue
14         Estonia   Pre UK rebate   0.176  orange
15         Estonia  Post UK rebate   0.176    blue
16         Denmark   Pre UK rebate   2.551  orange
17         Denmark  Post UK rebate   2.727    blue
18          Greece   Pre UK rebate   2.199  orange
19          Greece  Post UK rebate   2.375    blue
20         Belgium   Pre UK rebate   5.103  orange
21         Belgium  Post UK rebate   5.367    blue
22         Hungary   Pre UK rebate   1.144  orange
23         Hungary  Post UK rebate   1.232    blue
24  Czech Republic   Pre UK rebate   1.760  orange
25  Czech Republic  Post UK rebate   1.760    blue
26          Poland   Pre UK rebate   3.959  orange
27          Poland  Post UK rebate   4.223    blue
28         Romania   Pre UK rebate   1.408  orange
29         Romania  Post UK rebate   1.496    blue
30          Cyprus   Pre UK rebate   0.264  orange
31          Cyprus  Post UK rebate   0.264    blue
32              UK   Pre UK rebate  18.651  orange
33              UK  Post UK rebate  14.780    blue
34     Netherlands   Pre UK rebate   6.246  orange
35     Netherlands  Post UK rebate   6.510    blue
36        Portugal   Pre UK rebate   1.672  orange
37        Portugal  Post UK rebate   1.760    blue
38          Sweden   Pre UK rebate   3.695  orange
39          Sweden  Post UK rebate   3.695    blue
40           Malta   Pre UK rebate   0.000  orange
41           Malta  Post UK rebate   0.000    blue
42         Germany   Pre UK rebate  25.249  orange
43         Germany  Post UK rebate  25.601    blue
44           Spain   Pre UK rebate  10.821  orange
45           Spain  Post UK rebate  11.613    blue
46         Finland   Pre UK rebate   2.023  orange
47         Finland  Post UK rebate   2.199    blue
48          France   Pre UK rebate  19.795  orange
49          France  Post UK rebate  20.938    blue
50      Luxembourg   Pre UK rebate   0.440  orange
51      Luxembourg  Post UK rebate   0.440    blue
52         Austria   Pre UK rebate   2.727  orange
53         Austria  Post UK rebate   2.727    blue
# query is: Which country has the highest Post UK rebate budget?
# expected output type:[dtype('O')]
# expected output is:
    ANSWER
0  Germany
# inferred DSL terminals:
  # ConstVal: ['budget@Str', 'UK@Str', 'country@Str', 'Post UK rebate@Str', 'Pre UK rebate@Str', '<NULL>']
     # cmap: [('uk', 'UK'), ('uk', 'Pre UK rebate'), ('uk', 'Post UK rebate'), ('country', 'country'), ('post', 'Post UK rebate'), ('rebate', 'Pre UK rebate'), ('budget', 'budget'), ('rebate', 'Post UK rebate')]
  # AggrFunc: ['max', '<NULL>']
     # amap: [('highest', 'max')]
  # NumFunc: ['<NULL>']
     # nmap: []
  # BoolFunc: ['==', '<NULL>']
     # bmap: [(None, '==')]
  # IndFunc: ['eqmax', '<NULL>']
     # imap: [('highest', 'eqmax')]
# loading skeleton list...

# ========== candidate program report ========== #
# (t=0.00) i=0, candidate=[{'ANSWER': 'Latvia'}]
  # found 0 program(s)
# (t=7.23) i=1, candidate=[{'ANSWER': 'Bulgaria'}]
  # found 0 program(s)
# (t=14.42) i=2, candidate=[{'ANSWER': 'Slovakia'}]
  # found 0 program(s)
# (t=21.47) i=3, candidate=[{'ANSWER': 'Malta'}]
  # found 0 program(s)
# (t=28.48) i=4, candidate=[{'ANSWER': 'Cyprus'}]
  # found 0 program(s)
# (t=35.56) i=5, candidate=[{'ANSWER': 'Spain'}]
  # found 0 program(s)
# (t=42.61) i=6, candidate=[{'ANSWER': 'Lithuania'}]
  # found 0 program(s)
# (t=49.93) i=7, candidate=[{'ANSWER': 'Finland'}]
  # found 0 program(s)
# (t=56.99) i=8, candidate=[{'ANSWER': 'Luxembourg'}]
  # found 0 program(s)
# (t=64.04) i=9, candidate=[{'ANSWER': 'Slovenia'}]
  # found 0 program(s)
# (t=71.07) i=10, candidate=[{'ANSWER': 'Sweden'}]
  # found 0 program(s)
# (t=78.10) i=11, candidate=[{'ANSWER': 'Czech Republic'}]
  # found 0 program(s)
# (t=85.14) i=12, candidate=[{'ANSWER': 'Romania'}]
  # found 0 program(s)
# (t=92.28) i=13, candidate=[{'ANSWER': 'Denmark'}]
  # found 0 program(s)
# (t=99.43) i=14, candidate=[{'ANSWER': 'Greece'}]
  # found 0 program(s)
# (t=106.49) i=15, candidate=[{'ANSWER': 'Poland'}]
  # found 0 program(s)
# (t=113.52) i=16, candidate=[{'ANSWER': 'Ireland'}]
  # found 0 program(s)
# (t=120.70) i=17, candidate=[{'ANSWER': 'UK'}]
  # found 5 program(s)
    # SelectCol(SelectRow0(SelectRow1(@param0, ==, 0, UK@Str), eqmax, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['SelectRow1', 'input@0', '==', 'country', 'UK'], 'eqmax', 'budget'], ['country']]
    # SelectCol(SelectRow1(SelectRow1(@param0, ==, 0, UK@Str), ==, 1, Post UK rebate@Str), ['0'])
      --> ['SelectCol', ['SelectRow1', ['SelectRow1', 'input@0', '==', 'country', 'UK'], '==', 'budgetcategory', 'Post UK rebate'], ['country']]
    # SelectCol(SelectRow1(SelectRow1(@param0, ==, 0, UK@Str), ==, 1, Pre UK rebate@Str), ['0'])
      --> ['SelectCol', ['SelectRow1', ['SelectRow1', 'input@0', '==', 'country', 'UK'], '==', 'budgetcategory', 'Pre UK rebate'], ['country']]
    # SelectCol(SelectRow1(SelectRow1(@param0, ==, 1, Post UK rebate@Str), ==, 0, UK@Str), ['0'])
      --> ['SelectCol', ['SelectRow1', ['SelectRow1', 'input@0', '==', 'budgetcategory', 'Post UK rebate'], '==', 'country', 'UK'], ['country']]
    # SelectCol(SelectRow1(SelectRow1(@param0, ==, 1, Pre UK rebate@Str), ==, 0, UK@Str), ['0'])
      --> ['SelectCol', ['SelectRow1', ['SelectRow1', 'input@0', '==', 'budgetcategory', 'Pre UK rebate'], '==', 'country', 'UK'], ['country']]
# (t=128.23) i=18, candidate=[{'ANSWER': 'Germany'}]
  # found 15 program(s)
    # SelectCol(SelectRow0(SelectRow1(@param0, ==, 1, Post UK rebate@Str), eqmax, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['SelectRow1', 'input@0', '==', 'budgetcategory', 'Post UK rebate'], 'eqmax', 'budget'], ['country']]
    # SelectCol(SelectRow0(SelectRow1(@param0, ==, 1, Pre UK rebate@Str), eqmax, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['SelectRow1', 'input@0', '==', 'budgetcategory', 'Pre UK rebate'], 'eqmax', 'budget'], ['country']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0'], max, 2), eqmax, 1), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['country'], 'max', 'budget'], 'eqmax', 'COL0'], ['country']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0'], max, 2), eqmax, 1), ['-1'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['country'], 'max', 'budget'], 'eqmax', 'COL0'], ['country']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], max, 2), eqmax, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['country', 'budgetcategory'], 'max', 'budget'], 'eqmax', 'COL0'], ['country']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], max, 2), eqmax, 2), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['country', 'budgetcategory'], 'max', 'budget'], 'eqmax', 'COL0'], ['country']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '2'], max, 2), eqmax, 1), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['country', 'budget'], 'max', 'budget'], 'eqmax', 'budget'], ['country']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '2'], max, 2), eqmax, 1), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['country', 'budget'], 'max', 'budget'], 'eqmax', 'budget'], ['country']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '2'], max, 2), eqmax, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['country', 'budget'], 'max', 'budget'], 'eqmax', 'COL0'], ['country']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '2'], max, 2), eqmax, 2), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['country', 'budget'], 'max', 'budget'], 'eqmax', 'COL0'], ['country']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '3'], max, 2), eqmax, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['country', 'color'], 'max', 'budget'], 'eqmax', 'COL0'], ['country']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '3'], max, 2), eqmax, 2), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['country', 'color'], 'max', 'budget'], 'eqmax', 'COL0'], ['country']]
    # SelectCol(SelectRow0(@param0, eqmax, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', 'input@0', 'eqmax', 'budget'], ['country']]
    # SelectCol(SelectRow0(SelectRow1(SelectRow1(@param0, ==, 1, Post UK rebate@Str), ==, 1, Post UK rebate@Str), eqmax, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['SelectRow1', ['SelectRow1', 'input@0', '==', 'budgetcategory', 'Post UK rebate'], '==', 'budgetcategory', 'Post UK rebate'], 'eqmax', 'budget'], ['country']]
    # SelectCol(SelectRow0(SelectRow1(SelectRow1(@param0, ==, 1, Pre UK rebate@Str), ==, 1, Pre UK rebate@Str), eqmax, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['SelectRow1', ['SelectRow1', 'input@0', '==', 'budgetcategory', 'Pre UK rebate'], '==', 'budgetcategory', 'Pre UK rebate'], 'eqmax', 'budget'], ['country']]
# (t=135.46) i=19, candidate=[{'ANSWER': 'Belgium'}]
  # found 0 program(s)
# (t=142.56) i=20, candidate=[{'ANSWER': 'Italy'}]
  # found 0 program(s)
# (t=149.64) i=21, candidate=[{'ANSWER': 'Austria'}]
  # found 0 program(s)
# (t=156.62) i=22, candidate=[{'ANSWER': 'France'}]
  # found 0 program(s)
# (t=163.56) i=23, candidate=[{'ANSWER': 'Netherlands'}]
  # found 0 program(s)
# (t=170.52) i=24, candidate=[{'ANSWER': 'Estonia'}]
  # found 0 program(s)
# (t=177.47) i=25, candidate=[{'ANSWER': 'Portugal'}]
  # found 0 program(s)
# (t=184.45) i=26, candidate=[{'ANSWER': 'Hungary'}]
  # found 0 program(s)

# ========== review report ========== #
# top-1, score: 2.77, answer: Germany
  # tprog: SelectCol(SelectRow0(SelectRow1(@param0, ==, 1, Post UK rebate@Str), eqmax, 2), ['0'])
# top-2, score: 2.74, answer: Germany
  # tprog: SelectCol(SelectRow0(SelectRow1(SelectRow1(@param0, ==, 1, Post UK rebate@Str), ==, 1, Post UK rebate@Str), eqmax, 2), ['0'])
# top-3, score: 2.54, answer: UK
  # tprog: SelectCol(SelectRow0(SelectRow1(@param0, ==, 0, UK@Str), eqmax, 2), ['0'])
# top-4, score: 2.54, answer: UK
  # tprog: SelectCol(SelectRow1(SelectRow1(@param0, ==, 0, UK@Str), ==, 1, Post UK rebate@Str), ['0'])
# top-5, score: 2.54, answer: UK
  # tprog: SelectCol(SelectRow1(SelectRow1(@param0, ==, 1, Post UK rebate@Str), ==, 0, UK@Str), ['0'])
# top-6, score: 2.42, answer: UK
  # tprog: SelectCol(SelectRow1(SelectRow1(@param0, ==, 0, UK@Str), ==, 1, Pre UK rebate@Str), ['0'])
# top-7, score: 2.42, answer: UK
  # tprog: SelectCol(SelectRow1(SelectRow1(@param0, ==, 1, Pre UK rebate@Str), ==, 0, UK@Str), ['0'])
# top-8, score: 1.66, answer: Germany
  # tprog: SelectCol(SelectRow0(SelectRow1(@param0, ==, 1, Pre UK rebate@Str), eqmax, 2), ['0'])
# top-9, score: 1.63, answer: Germany
  # tprog: SelectCol(SelectRow0(SelectRow1(SelectRow1(@param0, ==, 1, Pre UK rebate@Str), ==, 1, Pre UK rebate@Str), eqmax, 2), ['0'])
# top-10, score: 1.50, answer: Germany
  # tprog: SelectCol(SelectRow0(@param0, eqmax, 2), ['0'])
# top-11, score: 1.43, answer: Germany
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0'], max, 2), eqmax, 1), ['0'])
# top-12, score: 1.43, answer: Germany
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0'], max, 2), eqmax, 1), ['-1'])
# top-13, score: 1.42, answer: Germany
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], max, 2), eqmax, 2), ['0'])
# top-14, score: 1.42, answer: Germany
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], max, 2), eqmax, 2), ['-1', '-2'])
# top-15, score: 1.42, answer: Germany
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '2'], max, 2), eqmax, 1), ['0'])
# top-16, score: 1.42, answer: Germany
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '2'], max, 2), eqmax, 1), ['-1', '-2'])
# top-17, score: 1.42, answer: Germany
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '2'], max, 2), eqmax, 2), ['0'])
# top-18, score: 1.42, answer: Germany
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '2'], max, 2), eqmax, 2), ['-1', '-2'])
# top-19, score: 1.42, answer: Germany
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '3'], max, 2), eqmax, 2), ['0'])
# top-20, score: 1.42, answer: Germany
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '3'], max, 2), eqmax, 2), ['-1', '-2'])
