# parsed arguments: Namespace(benchmark='Q4950a', dsl='meta_visqa', skeletons='visqa_normal', strategy='TaPas_C', fallback='auto', timeout=300, mode='full', expected_only=False)
# loading benchmark...
# table keywords: {'usa', '1349570000', 'fra', 'fin', '405800000', 'donation', 'gbr', 'swe', 'aus', 'nld', '1363080000', '672630000', 'kor', '18014480000', 'deu', 'color', '1372000000', '4870750000', 'bel', 'blue', '799520000', 'che', '2301450000', 'nor', 'esp', '2289930000', 'prt', 'can', '456310000', '372190000', '4769530000', 'country', 'jpn', '2329560000', '7020280000', '1802720000', '458880000', 'ita', '776670000', '5404860000', 'irl', '1890450000', 'aut', 'dnk'}
# input type: [dtype('int64'), dtype('O'), dtype('O')]
# input is:
       donation Country color
0   18014480000     USA  blue
1    7020280000     JPN  blue
2    5404860000     FRA  blue
3    4870750000     DEU  blue
4    4769530000     GBR  blue
5    2329560000     CAN  blue
6    2301450000     AUS  blue
7    2289930000     ESP  blue
8    1890450000     NLD  blue
9    1802720000     NOR  blue
10   1372000000     BEL  blue
11   1363080000     SWE  blue
12   1349570000     DNK  blue
13    799520000     KOR  blue
14    776670000     CHE  blue
15    672630000     ITA  blue
16    458880000     IRL  blue
17    456310000     FIN  blue
18    405800000     AUT  blue
19    372190000     PRT  blue
# query is: How much more aid has the USA given than Japan?
# expected output type:[dtype('int64')]
# expected output is:
        ANSWER
0  10994200000
# inferred DSL terminals:
  # ConstVal: ['USA@Str', '<NULL>']
     # cmap: [('usa', 'USA')]
  # AggrFunc: ['<NULL>']
     # amap: []
  # NumFunc: ['-', '<NULL>']
     # nmap: [('more', '-')]
  # BoolFunc: ['==', '>', '>=', '<NULL>']
     # bmap: [('more', '>='), ('more', '>'), (None, '==')]
  # IndFunc: ['<NULL>']
     # imap: []
# ====> fallback strategy (comparison) is triggered
  # [debug] high_values: []
  # [debug] high_values (no dup.): [(17642290000, 2), (17608680000, 2), (17558170000, 2), (17555600000, 2), (17341850000, 2), (17237810000, 2), (17214960000, 2), (16664910000, 2), (16651400000, 2), (16642480000, 2)]
# loading skeleton list...

# ========== candidate program report ========== #
# (t=0.00) i=0, candidate=[{'ANSWER': 1}]
  # found 0 program(s)
# (t=0.21) i=1, candidate=[{'ANSWER': 2}]
  # found 0 program(s)
# ====> fallback strategy (retrieval) is triggered because no explanation is found so far
# ====> retrieval_values: [1349570000, 1363080000, 1372000000, 18014480000, 1802720000, 1890450000, 2289930000, 2301450000, 2329560000, 372190000, 405800000, 456310000, 458880000, 4769530000, 4870750000, 5404860000, 672630000, 7020280000, 776670000, 799520000, 'AUS', 'AUT', 'BEL', 'CAN', 'CHE', 'Country', 'DEU', 'DNK', 'ESP', 'FIN', 'FRA', 'GBR', 'IRL', 'ITA', 'JPN', 'KOR', 'NLD', 'NOR', 'PRT', 'SWE', 'USA', 'blue', 'color', 'donation']
# (t=0.41) fallback i=0, candidate=[{'ANSWER': 1349570000}]
  # found 0 program(s)
# (t=0.71) fallback i=1, candidate=[{'ANSWER': 1363080000}]
  # found 0 program(s)
# (t=1.00) fallback i=2, candidate=[{'ANSWER': 1372000000}]
  # found 0 program(s)
# (t=1.29) fallback i=3, candidate=[{'ANSWER': 18014480000}]
  # found 2 program(s)
    # SelectCol(SelectRow1(@param0, ==, 1, USA@Str), ['0'])
      --> ['SelectCol', ['SelectRow1', 'input@0', '==', 'Country', 'USA'], ['donation']]
    # SelectCol(SelectRow1(@param0, ==, 1, USA@Str), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow1', 'input@0', '==', 'Country', 'USA'], ['donation']]
# (t=1.59) fallback i=4, candidate=[{'ANSWER': 1802720000}]
  # found 0 program(s)
# (t=1.88) fallback i=5, candidate=[{'ANSWER': 1890450000}]
  # found 0 program(s)
# (t=2.17) fallback i=6, candidate=[{'ANSWER': 2289930000}]
  # found 0 program(s)
# (t=2.45) fallback i=7, candidate=[{'ANSWER': 2301450000}]
  # found 0 program(s)
# (t=2.74) fallback i=8, candidate=[{'ANSWER': 2329560000}]
  # found 0 program(s)
# (t=3.03) fallback i=9, candidate=[{'ANSWER': 372190000}]
  # found 0 program(s)
# (t=3.32) fallback i=10, candidate=[{'ANSWER': 405800000}]
  # found 0 program(s)
# (t=3.61) fallback i=11, candidate=[{'ANSWER': 456310000}]
  # found 0 program(s)
# (t=3.90) fallback i=12, candidate=[{'ANSWER': 458880000}]
  # found 0 program(s)
# (t=4.19) fallback i=13, candidate=[{'ANSWER': 4769530000}]
  # found 0 program(s)
# (t=4.47) fallback i=14, candidate=[{'ANSWER': 4870750000}]
  # found 0 program(s)
# (t=4.76) fallback i=15, candidate=[{'ANSWER': 5404860000}]
  # found 0 program(s)
# (t=5.05) fallback i=16, candidate=[{'ANSWER': 672630000}]
  # found 0 program(s)
# (t=5.34) fallback i=17, candidate=[{'ANSWER': 7020280000}]
  # found 0 program(s)
# (t=5.62) fallback i=18, candidate=[{'ANSWER': 776670000}]
  # found 0 program(s)
# (t=5.91) fallback i=19, candidate=[{'ANSWER': 799520000}]
  # found 0 program(s)
# (t=6.19) fallback i=20, candidate=[{'ANSWER': 'AUS'}]
  # found 0 program(s)
# (t=6.48) fallback i=21, candidate=[{'ANSWER': 'AUT'}]
  # found 0 program(s)
# (t=6.76) fallback i=22, candidate=[{'ANSWER': 'BEL'}]
  # found 0 program(s)
# (t=7.05) fallback i=23, candidate=[{'ANSWER': 'CAN'}]
  # found 0 program(s)
# (t=7.34) fallback i=24, candidate=[{'ANSWER': 'CHE'}]
  # found 0 program(s)
# (t=7.62) fallback i=25, candidate=[{'ANSWER': 'Country'}]
  # found 0 program(s)
# (t=7.83) fallback i=26, candidate=[{'ANSWER': 'DEU'}]
  # found 0 program(s)
# (t=8.11) fallback i=27, candidate=[{'ANSWER': 'DNK'}]
  # found 0 program(s)
# (t=8.40) fallback i=28, candidate=[{'ANSWER': 'ESP'}]
  # found 0 program(s)
# (t=8.68) fallback i=29, candidate=[{'ANSWER': 'FIN'}]
  # found 0 program(s)
# (t=8.97) fallback i=30, candidate=[{'ANSWER': 'FRA'}]
  # found 0 program(s)
# (t=9.26) fallback i=31, candidate=[{'ANSWER': 'GBR'}]
  # found 0 program(s)
# (t=9.54) fallback i=32, candidate=[{'ANSWER': 'IRL'}]
  # found 0 program(s)
# (t=9.83) fallback i=33, candidate=[{'ANSWER': 'ITA'}]
  # found 0 program(s)
# (t=10.12) fallback i=34, candidate=[{'ANSWER': 'JPN'}]
  # found 0 program(s)
# (t=10.41) fallback i=35, candidate=[{'ANSWER': 'KOR'}]
  # found 0 program(s)
# (t=10.71) fallback i=36, candidate=[{'ANSWER': 'NLD'}]
  # found 0 program(s)
# (t=11.00) fallback i=37, candidate=[{'ANSWER': 'NOR'}]
  # found 0 program(s)
# (t=11.29) fallback i=38, candidate=[{'ANSWER': 'PRT'}]
  # found 0 program(s)
# (t=11.58) fallback i=39, candidate=[{'ANSWER': 'SWE'}]
  # found 0 program(s)
# (t=11.87) fallback i=40, candidate=[{'ANSWER': 'USA'}]
  # found 2 program(s)
    # SelectCol(SelectRow1(@param0, ==, 1, USA@Str), ['1'])
      --> ['SelectCol', ['SelectRow1', 'input@0', '==', 'Country', 'USA'], ['Country']]
    # SelectCol(SelectRow1(@param0, ==, 1, USA@Str), ['-99', '-2'])
      --> ['SelectCol', ['SelectRow1', 'input@0', '==', 'Country', 'USA'], ['Country']]
# (t=12.16) fallback i=41, candidate=[{'ANSWER': 'blue'}]
  # found 2 program(s)
    # SelectCol(SelectRow1(@param0, ==, 1, USA@Str), ['2'])
      --> ['SelectCol', ['SelectRow1', 'input@0', '==', 'Country', 'USA'], ['color']]
    # SelectCol(SelectRow1(@param0, ==, 1, USA@Str), ['-99', '-1'])
      --> ['SelectCol', ['SelectRow1', 'input@0', '==', 'Country', 'USA'], ['color']]
# (t=12.45) fallback i=42, candidate=[{'ANSWER': 'color'}]
  # found 0 program(s)
# (t=12.66) fallback i=43, candidate=[{'ANSWER': 'donation'}]
  # found 0 program(s)

# ========== review report ========== #
# top-1, score: 2.24, answer: 18014480000
  # tprog: SelectCol(SelectRow1(@param0, ==, 1, USA@Str), ['0'])
# top-2, score: 2.24, answer: 18014480000
  # tprog: SelectCol(SelectRow1(@param0, ==, 1, USA@Str), ['-1', '-2'])
# top-3, score: 2.24, answer: USA
  # tprog: SelectCol(SelectRow1(@param0, ==, 1, USA@Str), ['1'])
# top-4, score: 2.24, answer: USA
  # tprog: SelectCol(SelectRow1(@param0, ==, 1, USA@Str), ['-99', '-2'])
# top-5, score: 2.24, answer: blue
  # tprog: SelectCol(SelectRow1(@param0, ==, 1, USA@Str), ['2'])
# top-6, score: 2.24, answer: blue
  # tprog: SelectCol(SelectRow1(@param0, ==, 1, USA@Str), ['-99', '-1'])
