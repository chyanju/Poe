# parsed arguments: Namespace(benchmark='Q5d606', dsl='meta_visqa', skeletons='visqa_normal', strategy='TaPas_C', fallback='auto', timeout=300, mode='full', expected_only=False)
# loading benchmark...
# table keywords: {'egypt', 'bangladesh', '6.4', 'maldives', '16.6', 'germany', '26.0', '0.2', 'hong', '1.8', 'singapore', 'rwanda', 'japan', 'france', 'square', '25.4', '6.8', 'country', 'orange', 'australia', 'blue', '18.0', '0.4', 'kong', '9.7', 'color', '11.8', '7.4', '5.1', 'korea', 'persons', 'india', 'per', '25.2', '17.1', '75.2', 'total', '0.1', '20.8', 'kilometers', '1.0', 'monaco', 'brazil', '7.5', 'urban', 'urban/total', '21.5', 'south', '0.5', 'indonesia', 'macau', '3.9', '2.5'}
# input type: [dtype('O'), dtype('O'), dtype('float64'), dtype('O')]
# input is:
        Country Urban/total  Persons per square kilometers   color
0         Macau       Urban                           26.0  orange
1         Macau       Total                           20.8    blue
2         Japan       Urban                            3.9  orange
3         Japan       Total                            0.5    blue
4      Maldives       Urban                           21.5  orange
5      Maldives       Total                            1.0    blue
6        Rwanda       Urban                           18.0  orange
7        Rwanda       Total                            0.5    blue
8        Monaco       Urban                           17.1  orange
9        Monaco       Total                           17.1    blue
10    Australia       Urban                            1.8    blue
11   Bangladesh       Urban                           75.2  orange
12   Bangladesh       Total                            1.0    blue
13    Indonesia       Urban                           16.6  orange
14    Indonesia       Total                            0.1    blue
15        Egypt       Urban                            5.1  orange
16        Egypt       Total                            0.1    blue
17        India       Urban                           25.2  orange
18        India       Total                            0.4    blue
19       France       Urban                            2.5  orange
20       France       Total                            0.1    blue
21      Germany       Urban                            6.8  orange
22      Germany       Total                            0.2    blue
23  South Korea       Urban                           11.8  orange
24  South Korea       Total                            0.5    blue
25    Hong Kong       Urban                           25.4  orange
26    Hong Kong       Total                            6.4    blue
27       Brazil       Urban                            9.7    blue
28    Singapore       Urban                            7.5  orange
29    Singapore       Total                            7.4    blue
# query is: Which country or principality has the smallest difference between urban population density and overall population density?
# expected output type:[dtype('O')]
# expected output is:
   ANSWER
0  Monaco
# inferred DSL terminals:
  # ConstVal: ['Urban/total@Str', 'Urban@Str', 'Country@Str', '<NULL>']
     # cmap: [('urban', 'Urban/total'), ('urban', 'Urban'), ('country', 'Country')]
  # AggrFunc: ['sum', 'min', '<NULL>']
     # amap: [('overall', 'sum'), ('smallest', 'min')]
  # NumFunc: ['diff', '<NULL>']
     # nmap: [('difference', 'diff')]
  # BoolFunc: ['==', '<NULL>']
     # bmap: [(None, '==')]
  # IndFunc: ['eqmin', '<NULL>']
     # imap: [('smallest', 'eqmin')]
# ====> fallback strategy (comparison) is triggered
  # [debug] high_values: [(73.4, 4), (72.7, 4), (71.3, 4), (70.10000000000001, 4), (68.4, 4), (67.7, 4), (65.5, 4), (63.400000000000006, 4), (58.6, 4), (58.1, 4)]
  # [debug] high_values (no dup.): [(73.4, 4), (72.7, 4), (71.3, 4), (70.10000000000001, 4), (68.4, 4), (67.7, 4), (65.5, 4), (63.400000000000006, 4), (58.6, 4), (58.1, 4)]
  # [debug] filtered low_values (no dup.): [(75.10000000000001, 2), (75.10000000000001, 2), (75.10000000000001, 2), (75.0, 2), (74.8, 2), (74.7, 2), (74.7, 2), (74.7, 2), (74.2, 2), (74.2, 2)]
  # [debug] fallback (comparison) answers are added
# ====> fallback strategy (selection) is triggered
  # [debug] fallback (selection) answers: ['Urban/total', 'Urban', 'Country']
  # [debug] fallback (selection) answers (no dup.): ['Urban/total', 'Urban', 'Country']
  # [debug] 3 fallback (selection) answers are added
# loading skeleton list...

# ========== candidate program report ========== #
# (t=0.00) i=0, candidate=[{'ANSWER': 'Macau'}]
  # found 0 program(s)
# (t=4.07) i=1, candidate=[{'ANSWER': 'Maldives'}]
  # found 0 program(s)
# (t=8.14) i=2, candidate=[{'ANSWER': 'Monaco'}]
  # found 0 program(s)
# (t=12.24) i=3, candidate=[{'ANSWER': 'Japan'}]
  # found 0 program(s)
# (t=16.35) i=4, candidate=[{'ANSWER': 'Rwanda'}]
  # found 0 program(s)
# (t=20.45) i=5, candidate=[{'ANSWER': 'Germany'}]
  # found 0 program(s)
# (t=24.58) i=6, candidate=[{'ANSWER': 'Bangladesh'}]
  # found 0 program(s)
# (t=28.70) i=7, candidate=[{'ANSWER': 'France'}]
  # found 0 program(s)
# (t=32.83) i=8, candidate=[{'ANSWER': 'Indonesia'}]
  # found 0 program(s)
# (t=36.96) i=9, candidate=[{'ANSWER': 'India'}]
  # found 0 program(s)
# (t=41.09) i=10, candidate=[{'ANSWER': 'Singapore'}]
  # found 0 program(s)
# (t=45.17) i=11, candidate=[{'ANSWER': 'South Korea'}]
  # found 0 program(s)
# (t=49.29) i=12, candidate=[{'ANSWER': 'Egypt'}]
  # found 0 program(s)
# (t=53.69) i=13, candidate=[{'ANSWER': 'Australia'}]
  # found 4 program(s)
    # SelectCol(SelectRow0(SelectRow1(@param0, ==, 1, Urban@Str), eqmin, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['SelectRow1', 'input@0', '==', 'Urban/total', 'Urban'], 'eqmin', 'Persons per square kilometers'], ['Country']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0'], sum, 2), eqmin, 1), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['Country'], 'sum', 'Persons per square kilometers'], 'eqmin', 'COL0'], ['Country']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0'], sum, 2), eqmin, 1), ['-1'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['Country'], 'sum', 'Persons per square kilometers'], 'eqmin', 'COL0'], ['Country']]
    # SelectCol(SelectRow0(SelectRow1(SelectRow1(@param0, ==, 1, Urban@Str), ==, 1, Urban@Str), eqmin, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['SelectRow1', ['SelectRow1', 'input@0', '==', 'Urban/total', 'Urban'], '==', 'Urban/total', 'Urban'], 'eqmin', 'Persons per square kilometers'], ['Country']]
# (t=57.83) i=14, candidate=[{'ANSWER': 'Hong Kong'}]
  # found 0 program(s)
# (t=61.89) i=15, candidate=[{'ANSWER': 73.4}]
  # found 0 program(s)
# (t=64.98) i=16, candidate=[{'ANSWER': 72.7}]
  # found 0 program(s)
# (t=68.08) i=17, candidate=[{'ANSWER': 71.3}]
  # found 0 program(s)
# (t=71.17) i=18, candidate=[{'ANSWER': 70.10000000000001}]
  # found 0 program(s)
# (t=74.27) i=19, candidate=[{'ANSWER': 68.4}]
  # found 0 program(s)
# (t=77.37) i=20, candidate=[{'ANSWER': 67.7}]
  # found 0 program(s)
# (t=80.48) i=21, candidate=[{'ANSWER': 65.5}]
  # found 0 program(s)
# (t=83.58) i=22, candidate=[{'ANSWER': 63.400000000000006}]
  # found 0 program(s)
# (t=86.67) i=23, candidate=[{'ANSWER': 58.6}]
  # found 0 program(s)
# (t=89.74) i=24, candidate=[{'ANSWER': 58.1}]
  # found 0 program(s)
# (t=92.83) i=25, candidate=[{'ANSWER': 75.10000000000001}]
  # found 0 program(s)
# (t=95.96) i=26, candidate=[{'ANSWER': 75.10000000000001}]
  # found 0 program(s)
# (t=99.08) i=27, candidate=[{'ANSWER': 75.10000000000001}]
  # found 0 program(s)
# (t=102.18) i=28, candidate=[{'ANSWER': 75.0}]
  # found 0 program(s)
# (t=105.27) i=29, candidate=[{'ANSWER': 74.8}]
  # found 0 program(s)
# (t=108.41) i=30, candidate=[{'ANSWER': 74.7}]
  # found 0 program(s)
# (t=111.51) i=31, candidate=[{'ANSWER': 74.7}]
  # found 0 program(s)
# (t=114.62) i=32, candidate=[{'ANSWER': 74.7}]
  # found 0 program(s)
# (t=117.76) i=33, candidate=[{'ANSWER': 74.2}]
  # found 0 program(s)
# (t=120.88) i=34, candidate=[{'ANSWER': 74.2}]
  # found 0 program(s)
# (t=123.98) i=35, candidate=[{'ANSWER': 'Urban/total'}]
  # found 0 program(s)
# (t=127.08) i=36, candidate=[{'ANSWER': 'Urban'}]
  # found 4 program(s)
    # SelectCol(SelectRow0(SelectRow1(@param0, ==, 1, Urban@Str), eqmin, 2), ['1'])
      --> ['SelectCol', ['SelectRow0', ['SelectRow1', 'input@0', '==', 'Urban/total', 'Urban'], 'eqmin', 'Persons per square kilometers'], ['Urban/total']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], sum, 2), eqmin, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['Urban/total', 'color'], 'sum', 'Persons per square kilometers'], 'eqmin', 'COL0'], ['Urban/total']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], sum, 2), eqmin, 2), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['Urban/total', 'color'], 'sum', 'Persons per square kilometers'], 'eqmin', 'COL0'], ['Urban/total']]
    # SelectCol(SelectRow0(SelectRow1(SelectRow1(@param0, ==, 1, Urban@Str), ==, 1, Urban@Str), eqmin, 2), ['1'])
      --> ['SelectCol', ['SelectRow0', ['SelectRow1', ['SelectRow1', 'input@0', '==', 'Urban/total', 'Urban'], '==', 'Urban/total', 'Urban'], 'eqmin', 'Persons per square kilometers'], ['Urban/total']]
# (t=131.18) i=37, candidate=[{'ANSWER': 'Country'}]
  # found 0 program(s)

# ========== review report ========== #
# top-1, score: 2.29, answer: ['Australia']
  # tprog: SelectCol(SelectRow0(SelectRow1(@param0, ==, 1, Urban@Str), eqmin, 2), ['0'])
# top-2, score: 2.26, answer: ['Australia']
  # tprog: SelectCol(SelectRow0(SelectRow1(SelectRow1(@param0, ==, 1, Urban@Str), ==, 1, Urban@Str), eqmin, 2), ['0'])
# top-3, score: 2.23, answer: ['Urban']
  # tprog: SelectCol(SelectRow0(SelectRow1(@param0, ==, 1, Urban@Str), eqmin, 2), ['1'])
# top-4, score: 2.20, answer: ['Urban']
  # tprog: SelectCol(SelectRow0(SelectRow1(SelectRow1(@param0, ==, 1, Urban@Str), ==, 1, Urban@Str), eqmin, 2), ['1'])
# top-5, score: 1.29, answer: ['Australia']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0'], sum, 2), eqmin, 1), ['0'])
# top-6, score: 1.29, answer: ['Australia']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0'], sum, 2), eqmin, 1), ['-1'])
# top-7, score: 1.28, answer: ['Urban']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], sum, 2), eqmin, 2), ['0'])
# top-8, score: 1.28, answer: ['Urban']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], sum, 2), eqmin, 2), ['-1', '-2'])
