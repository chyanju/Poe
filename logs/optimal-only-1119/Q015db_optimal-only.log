# parsed arguments: Namespace(benchmark='Q015db', dsl='meta_visqa', skeletons='visqa_normal', strategy='TaPas_C', fallback='auto', timeout=300, mode='optimal-only', expected_only=False)
# loading benchmark...
# table keywords: {'36', '61', 'rain', '89', 'apr', 'fog', '34', 'yellow', '37', '45', '55', 'nov', '1', 'pink', 'snow', '2', 'drizzle', '71', '50', 'weather', 'aug', 'mar', 'may', '13', 'blue', 'gray', '94', 'sep', '23', 'sun', 'jun', 'date', '35', '16', '(month)', '54', 'count', 'oct', '85', 'dec', '82', '5', '19', 'jul', '25', 'records', 'jan', '20', '6', '3', '42', '33', '8', '4', 'color', '10', 'feb', '40', '38', '14', '30'}
# input type: [dtype('O'), dtype('O'), dtype('int64'), dtype('O')]
# input is:
    weather date (month)  Count of Records   color
0   drizzle          Jan                10    pink
1      rain          Jan                35    blue
2       sun          Jan                33  yellow
3      snow          Jan                 8    gray
4      rain          Feb                40    blue
5       sun          Feb                30  yellow
6   drizzle          Feb                 4    pink
7      snow          Feb                 3    gray
8       sun          Mar                42  yellow
9      rain          Mar                37    blue
10     snow          Mar                 6    gray
11  drizzle          Mar                 3    pink
12     rain          Apr                20    blue
13      sun          Apr                61  yellow
14     snow          Apr                 1    gray
15  drizzle          Apr                 4    pink
16     rain          May                16    blue
17      sun          May                82  yellow
18  drizzle          May                 1    pink
19     rain          Jun                19    blue
20      sun          Jun                85  yellow
21  drizzle          Jun                 2    pink
22     rain          Jul                14    blue
23      sun          Jul                89  yellow
24  drizzle          Jul                 8    pink
25      fog          Jul                13    pink
26  drizzle          Aug                 8    pink
27      sun          Aug                94  yellow
28     rain          Aug                 6    blue
29      sun          Sep                71  yellow
30     rain          Sep                 4    blue
31      fog          Sep                40    pink
32  drizzle          Sep                 5    pink
33      sun          Oct                45  yellow
34  drizzle          Oct                 4    pink
35     rain          Oct                20    blue
36     rain          Nov                25    blue
37      sun          Nov                42  yellow
38  drizzle          Nov                 3    pink
39      fog          Nov                50    pink
40     rain          Dec                23    blue
41      sun          Dec                40  yellow
42     snow          Dec                 5    gray
43  drizzle          Dec                 2    pink
44      fog          Mar                36    pink
45      fog          Apr                34    pink
46      fog          May                25    pink
47      fog          Jun                14    pink
48      fog          Aug                16    pink
49      fog          Oct                55    pink
50      fog          Dec                54    pink
51      fog          Jan                38    pink
52      fog          Feb                36    pink
# query is: What month has the most sun?
# expected output type:[dtype('O')]
# expected output is:
  ANSWER
0    Aug
# inferred DSL terminals:
  # ConstVal: ['date (month)@Str', 'sun@Str', '<NULL>']
     # cmap: [('month', 'date (month)'), ('sun', 'sun')]
  # AggrFunc: ['max', '<NULL>']
     # amap: [('most', 'max')]
  # NumFunc: ['<NULL>']
     # nmap: []
  # BoolFunc: ['==', '<NULL>']
     # bmap: [(None, '==')]
  # IndFunc: ['eqmax', '<NULL>']
     # imap: [('most', 'eqmax')]
# loading skeleton list...

# ========== candidate program report ========== #
# (t=0.00) i=0, candidate=[{'ANSWER': 'Jan'}]
  # found 0 program(s)
# (t=2.73) i=1, candidate=[{'ANSWER': 'Jun'}]
  # found 0 program(s)
# (t=5.46) i=2, candidate=[{'ANSWER': 'Nov'}]
  # found 0 program(s)
# (t=8.17) i=3, candidate=[{'ANSWER': 'Dec'}]
  # found 0 program(s)
# (t=11.17) i=4, candidate=[{'ANSWER': 'Feb'}]
  # found 0 program(s)
# (t=13.86) i=5, candidate=[{'ANSWER': 'May'}]
  # found 0 program(s)
# (t=16.58) i=6, candidate=[{'ANSWER': 'Aug'}]
  # found 13 program(s)
    # SelectCol(SelectRow0(SelectRow1(@param0, ==, 0, sun@Str), eqmax, 2), ['1'])
      --> ['SelectCol', ['SelectRow0', ['SelectRow1', 'input@0', '==', 'weather', 'sun'], 'eqmax', 'Count of Records'], ['date (month)']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1'], max, 2), eqmax, 1), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['date (month)'], 'max', 'Count of Records'], 'eqmax', 'COL0'], ['date (month)']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1'], max, 2), eqmax, 1), ['-1'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['date (month)'], 'max', 'Count of Records'], 'eqmax', 'COL0'], ['date (month)']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], max, 2), eqmax, 2), ['1'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['weather', 'date (month)'], 'max', 'Count of Records'], 'eqmax', 'COL0'], ['date (month)']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], max, 2), eqmax, 2), ['-99', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['weather', 'date (month)'], 'max', 'Count of Records'], 'eqmax', 'COL0'], ['date (month)']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], max, 2), eqmax, 1), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['date (month)', 'Count of Records'], 'max', 'Count of Records'], 'eqmax', 'Count of Records'], ['date (month)']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], max, 2), eqmax, 1), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['date (month)', 'Count of Records'], 'max', 'Count of Records'], 'eqmax', 'Count of Records'], ['date (month)']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], max, 2), eqmax, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['date (month)', 'Count of Records'], 'max', 'Count of Records'], 'eqmax', 'COL0'], ['date (month)']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], max, 2), eqmax, 2), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['date (month)', 'Count of Records'], 'max', 'Count of Records'], 'eqmax', 'COL0'], ['date (month)']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], max, 2), eqmax, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['date (month)', 'color'], 'max', 'Count of Records'], 'eqmax', 'COL0'], ['date (month)']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], max, 2), eqmax, 2), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['date (month)', 'color'], 'max', 'Count of Records'], 'eqmax', 'COL0'], ['date (month)']]
    # SelectCol(SelectRow0(@param0, eqmax, 2), ['1'])
      --> ['SelectCol', ['SelectRow0', 'input@0', 'eqmax', 'Count of Records'], ['date (month)']]
    # SelectCol(SelectRow0(SelectRow1(SelectRow1(@param0, ==, 0, sun@Str), ==, 0, sun@Str), eqmax, 2), ['1'])
      --> ['SelectCol', ['SelectRow0', ['SelectRow1', ['SelectRow1', 'input@0', '==', 'weather', 'sun'], '==', 'weather', 'sun'], 'eqmax', 'Count of Records'], ['date (month)']]
# (t=19.36) i=7, candidate=[{'ANSWER': 'Jul'}]
  # found 0 program(s)
# (t=22.09) i=8, candidate=[{'ANSWER': 'Sep'}]
  # found 0 program(s)
# (t=25.16) i=9, candidate=[{'ANSWER': 'Mar'}]
  # found 0 program(s)
# (t=27.88) i=10, candidate=[{'ANSWER': 'Apr'}]
  # found 0 program(s)
# (t=30.59) i=11, candidate=[{'ANSWER': 'Oct'}]
  # found 0 program(s)

# ========== review report ========== #
# top-1, score: 2.60, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(SelectRow1(@param0, ==, 0, sun@Str), eqmax, 2), ['1'])
# top-2, score: 2.57, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(SelectRow1(SelectRow1(@param0, ==, 0, sun@Str), ==, 0, sun@Str), eqmax, 2), ['1'])
# top-3, score: 1.50, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(@param0, eqmax, 2), ['1'])
# top-4, score: 1.43, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1'], max, 2), eqmax, 1), ['0'])
# top-5, score: 1.43, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1'], max, 2), eqmax, 1), ['-1'])
# top-6, score: 1.42, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], max, 2), eqmax, 2), ['1'])
# top-7, score: 1.42, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], max, 2), eqmax, 2), ['-99', '-2'])
# top-8, score: 1.42, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], max, 2), eqmax, 1), ['0'])
# top-9, score: 1.42, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], max, 2), eqmax, 1), ['-1', '-2'])
# top-10, score: 1.42, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], max, 2), eqmax, 2), ['0'])
# top-11, score: 1.42, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], max, 2), eqmax, 2), ['-1', '-2'])
# top-12, score: 1.42, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], max, 2), eqmax, 2), ['0'])
# top-13, score: 1.42, answer: ['Aug']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], max, 2), eqmax, 2), ['-1', '-2'])
