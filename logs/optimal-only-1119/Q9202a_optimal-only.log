# parsed arguments: Namespace(benchmark='Q9202a', dsl='meta_visqa', skeletons='visqa_normal', strategy='TaPas_C', fallback='auto', timeout=300, mode='optimal-only', expected_only=False)
# loading benchmark...
# table keywords: {'trebi', '47.93333', 'variety', '73.06667', 'manchuria', 'yellow', '64.3', '46.3', '88.03334', '56.3', '60.8', '55.26666', '90.4', '66.83333', 'farm', '100.3', 'red', 'green', 'waseca', 'sum', '64.96666', '462', 'blue', '82.33334', '51.53334', '61.8', 'orange', '60.83334', '55.1', '76.23333', '73.39999', '55.53334', 'peatland', '60.93333', '43.56666', '63.36667', '48.76667', '79.86666', 'color', 'university', '84.59999', '50.6', '62.56667', '475', '69.70001', '38', '85.83333', '72.9', 'teal', 'rapids', '85.76667', '457', '55.13334', '76.63334', 'morris', '63.9', '61.46667', '50.4', '80.0', '77.36667', 'yield', '61.1', 'duluth', 'site', 'svansota', '54.66667', '87.63333', 'grand', 'glabron', '113.0666', 'wisconsin', '92.93333', '88.76666', 'velvet', '79.09999', '51.63334', 'crookston', '66.7', '77.3', '60.43333', '110.4667', '34.93333', '53.9', '116.96667', '72.23334', '65.63333', 'no.', '62.16667', '44.83334', '64.53333'}
# input type: [dtype('O'), dtype('O'), dtype('float64'), dtype('O')]
# input is:
             variety             site  Sum of yield   color
0          Manchuria  University Farm      53.90000   green
1          Manchuria           Waseca      82.33334  yellow
2          Manchuria           Morris      61.80000    teal
3          Manchuria        Crookston      72.90000    blue
4          Manchuria     Grand Rapids      55.10000     red
5          Manchuria           Duluth      51.53334  orange
6            Glabron  University Farm      79.86666   green
7            Glabron           Waseca      92.93333  yellow
8            Glabron           Morris      63.90000    teal
9            Glabron        Crookston      64.30000    blue
10           Glabron     Grand Rapids      43.56666     red
11           Glabron           Duluth      55.53334  orange
12          Svansota  University Farm      62.56667   green
13          Svansota           Waseca      85.83333  yellow
14          Svansota           Morris      60.80000    teal
15          Svansota        Crookston      61.10000    blue
16          Svansota     Grand Rapids      46.30000     red
17          Svansota           Duluth      47.93333  orange
18            Velvet  University Farm      66.70000   green
19            Velvet           Waseca      87.63333  yellow
20            Velvet           Morris      64.96666    teal
21            Velvet        Crookston      73.39999    blue
22            Velvet     Grand Rapids      55.26666     red
23            Velvet           Duluth      48.76667  orange
24             Trebi  University Farm      65.63333   green
25             Trebi           Waseca     113.06660  yellow
26             Trebi           Morris      90.40000    teal
27             Trebi        Crookston      88.76666    blue
28             Trebi     Grand Rapids      50.40000     red
29             Trebi           Duluth      64.53333  orange
30           No. 457  University Farm      69.70001   green
31           No. 457           Waseca     100.30000  yellow
32           No. 457           Morris      72.23334    teal
33           No. 457        Crookston      80.00000    blue
34           No. 457     Grand Rapids      51.63334     red
35           No. 457           Duluth      56.30000  orange
36           No. 462  University Farm      62.16667   green
37           No. 462           Waseca     110.46670  yellow
38           No. 462           Morris      77.36667    teal
39           No. 462        Crookston      79.09999    blue
40           No. 462     Grand Rapids      44.83334     red
41           No. 462           Duluth      50.60000  orange
42          Peatland  University Farm      60.83334   green
43          Peatland           Waseca      84.59999  yellow
44          Peatland           Morris      73.06667    teal
45          Peatland        Crookston      66.83333    blue
46          Peatland     Grand Rapids      61.46667     red
47          Peatland           Duluth      63.36667  orange
48           No. 475  University Farm      54.66667   green
49           No. 475           Waseca      88.03334  yellow
50           No. 475           Morris      66.83333    teal
51           No. 475        Crookston      76.23333    blue
52           No. 475     Grand Rapids      34.93333     red
53           No. 475           Duluth      60.43333  orange
54  Wisconsin No. 38  University Farm      77.30000   green
55  Wisconsin No. 38           Waseca     116.96667  yellow
56  Wisconsin No. 38           Morris      76.63334    teal
57  Wisconsin No. 38        Crookston      85.76667    blue
58  Wisconsin No. 38     Grand Rapids      55.13334     red
59  Wisconsin No. 38           Duluth      60.93333  orange
# query is: Which site has the lowest overall yield of barley?
# expected output type:[dtype('O')]
# expected output is:
         ANSWER
0  Grand Rapids
# inferred DSL terminals:
  # ConstVal: ['site@Str', 'Sum of yield@Str', '<NULL>']
     # cmap: [('site', 'site'), ('yield', 'Sum of yield')]
  # AggrFunc: ['sum', 'min', '<NULL>']
     # amap: [('overall', 'sum'), ('lowest', 'min')]
  # NumFunc: ['<NULL>']
     # nmap: []
  # BoolFunc: ['==', '<NULL>']
     # bmap: [(None, '==')]
  # IndFunc: ['eqmin', '<NULL>']
     # imap: [('lowest', 'eqmin')]
# loading skeleton list...

# ========== candidate program report ========== #
# (t=0.00) i=0, candidate=[{'ANSWER': 'Grand Rapids'}]
  # found 21 program(s)
    # SelectCol(SelectRow0(GroupSum(@param0, ['1'], sum, 2), eqmin, 1), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site'], 'sum', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1'], sum, 2), eqmin, 1), ['-1'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site'], 'sum', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1'], min, 2), eqmin, 1), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site'], 'min', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1'], min, 2), eqmin, 1), ['-1'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site'], 'min', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], sum, 2), eqmin, 2), ['1'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['variety', 'site'], 'sum', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], sum, 2), eqmin, 2), ['-99', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['variety', 'site'], 'sum', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], min, 2), eqmin, 2), ['1'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['variety', 'site'], 'min', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], min, 2), eqmin, 2), ['-99', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['variety', 'site'], 'min', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], sum, 2), eqmin, 1), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site', 'Sum of yield'], 'sum', 'Sum of yield'], 'eqmin', 'Sum of yield'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], sum, 2), eqmin, 1), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site', 'Sum of yield'], 'sum', 'Sum of yield'], 'eqmin', 'Sum of yield'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], sum, 2), eqmin, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site', 'Sum of yield'], 'sum', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], sum, 2), eqmin, 2), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site', 'Sum of yield'], 'sum', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], min, 2), eqmin, 1), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site', 'Sum of yield'], 'min', 'Sum of yield'], 'eqmin', 'Sum of yield'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], min, 2), eqmin, 1), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site', 'Sum of yield'], 'min', 'Sum of yield'], 'eqmin', 'Sum of yield'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], min, 2), eqmin, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site', 'Sum of yield'], 'min', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], min, 2), eqmin, 2), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site', 'Sum of yield'], 'min', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], sum, 2), eqmin, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site', 'color'], 'sum', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], sum, 2), eqmin, 2), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site', 'color'], 'sum', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], min, 2), eqmin, 2), ['0'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site', 'color'], 'min', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], min, 2), eqmin, 2), ['-1', '-2'])
      --> ['SelectCol', ['SelectRow0', ['GroupSum', 'input@0', ['site', 'color'], 'min', 'Sum of yield'], 'eqmin', 'COL0'], ['site']]
    # SelectCol(SelectRow0(@param0, eqmin, 2), ['1'])
      --> ['SelectCol', ['SelectRow0', 'input@0', 'eqmin', 'Sum of yield'], ['site']]
# (t=3.04) i=1, candidate=[{'ANSWER': 'University Farm'}]
  # found 0 program(s)
# (t=5.96) i=2, candidate=[{'ANSWER': 'Waseca'}]
  # found 0 program(s)
# (t=8.88) i=3, candidate=[{'ANSWER': 'Duluth'}]
  # found 0 program(s)
# (t=12.08) i=4, candidate=[{'ANSWER': 'Morris'}]
  # found 0 program(s)
# (t=14.96) i=5, candidate=[{'ANSWER': 'Crookston'}]
  # found 0 program(s)

# ========== review report ========== #
# top-1, score: 1.54, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1'], sum, 2), eqmin, 1), ['0'])
# top-2, score: 1.54, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1'], sum, 2), eqmin, 1), ['-1'])
# top-3, score: 1.54, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], sum, 2), eqmin, 2), ['1'])
# top-4, score: 1.54, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], sum, 2), eqmin, 2), ['-99', '-2'])
# top-5, score: 1.54, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], sum, 2), eqmin, 1), ['0'])
# top-6, score: 1.54, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], sum, 2), eqmin, 1), ['-1', '-2'])
# top-7, score: 1.54, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], sum, 2), eqmin, 2), ['0'])
# top-8, score: 1.54, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], sum, 2), eqmin, 2), ['-1', '-2'])
# top-9, score: 1.54, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], sum, 2), eqmin, 2), ['0'])
# top-10, score: 1.54, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], sum, 2), eqmin, 2), ['-1', '-2'])
# top-11, score: 1.50, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(@param0, eqmin, 2), ['1'])
# top-12, score: 1.43, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1'], min, 2), eqmin, 1), ['0'])
# top-13, score: 1.43, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1'], min, 2), eqmin, 1), ['-1'])
# top-14, score: 1.42, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], min, 2), eqmin, 2), ['1'])
# top-15, score: 1.42, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['0', '1'], min, 2), eqmin, 2), ['-99', '-2'])
# top-16, score: 1.42, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], min, 2), eqmin, 1), ['0'])
# top-17, score: 1.42, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], min, 2), eqmin, 1), ['-1', '-2'])
# top-18, score: 1.42, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], min, 2), eqmin, 2), ['0'])
# top-19, score: 1.42, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '2'], min, 2), eqmin, 2), ['-1', '-2'])
# top-20, score: 1.42, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], min, 2), eqmin, 2), ['0'])
# top-21, score: 1.42, answer: ['Grand Rapids']
  # tprog: SelectCol(SelectRow0(GroupSum(@param0, ['1', '3'], min, 2), eqmin, 2), ['-1', '-2'])
